(()=>{var e={};e.id=78,e.ids=[78],e.modules={96330:e=>{"use strict";e.exports=require("@prisma/client")},10846:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},44870:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},19121:e=>{"use strict";e.exports=require("next/dist/server/app-render/action-async-storage.external.js")},3295:e=>{"use strict";e.exports=require("next/dist/server/app-render/after-task-async-storage.external.js")},29294:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-async-storage.external.js")},63033:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-unit-async-storage.external.js")},79428:e=>{"use strict";e.exports=require("buffer")},79646:e=>{"use strict";e.exports=require("child_process")},55511:e=>{"use strict";e.exports=require("crypto")},29021:e=>{"use strict";e.exports=require("fs")},79748:e=>{"use strict";e.exports=require("fs/promises")},81630:e=>{"use strict";e.exports=require("http")},73496:e=>{"use strict";e.exports=require("http2")},55591:e=>{"use strict";e.exports=require("https")},21820:e=>{"use strict";e.exports=require("os")},33873:e=>{"use strict";e.exports=require("path")},19771:e=>{"use strict";e.exports=require("process")},27910:e=>{"use strict";e.exports=require("stream")},79551:e=>{"use strict";e.exports=require("url")},28354:e=>{"use strict";e.exports=require("util")},77598:e=>{"use strict";e.exports=require("node:crypto")},36954:(e,r,t)=>{"use strict";t.r(r),t.d(r,{patchFetch:()=>y,routeModule:()=>w,serverHooks:()=>g,workAsyncStorage:()=>m,workUnitAsyncStorage:()=>h});var s={};t.r(s),t.d(s,{GET:()=>x,POST:()=>d});var n=t(42706),i=t(28203),a=t(45994),c=t(39187),o=t(89547),u=t(84908),p=t(1198),l=t(19390);async function d(e){try{let{userId:r}=await (0,o.j)();if(!r)return new c.NextResponse("Unauthorized",{status:401});let{name:t}=await e.json();if(!t)return new c.NextResponse("Channel name is required",{status:400});let s=await u.z.channel.create({data:{name:t,members:{create:[{userId:r}]}},include:{members:{include:{user:{select:{id:!0,username:!0,imageUrl:!0}}}}}}),n=await u.z.connection.findMany();return await Promise.all(n.map(async e=>{try{await p.Yv?.send(new l.p({ConnectionId:e.connectionId,Data:Buffer.from(JSON.stringify({action:"channel-created",data:s}))}))}catch(e){}})),c.NextResponse.json(s)}catch(e){return new c.NextResponse("Internal Error",{status:500})}}async function x(e){try{let{userId:e}=await (0,o.j)();if(!e)return new Response("Unauthorized",{status:401});if(!await u.z.user.findUnique({where:{id:e},include:{channels:{include:{channel:!0}}}}))return new Response("User not found",{status:404});let r=await u.z.channel.findMany({where:{members:{some:{userId:e}}},include:{members:{include:{user:!0}}}});return Response.json(r)}catch(e){return new Response("Internal Server Error",{status:500})}}let w=new n.AppRouteRouteModule({definition:{kind:i.RouteKind.APP_ROUTE,page:"/api/channels/route",pathname:"/api/channels",filename:"route",bundlePath:"app/api/channels/route"},resolvedPagePath:"/Users/gagemccoy/Documents/ChatGenius/app/api/channels/route.ts",nextConfigOutput:"",userland:s}),{workAsyncStorage:m,workUnitAsyncStorage:h,serverHooks:g}=w;function y(){return(0,a.patchFetch)({workAsyncStorage:m,workUnitAsyncStorage:h})}},96487:()=>{},78335:()=>{},1198:(e,r,t)=>{"use strict";t.d(r,{Yv:()=>o});let s=require("@aws-sdk/client-s3");var n=t(54197);let i={region:"us-east-1",websocketUrl:"wss://r3jbyk1rrk.execute-api.us-east-1.amazonaws.com/production",bucketName:"chatgenius-gm-data",credentials:{accessKeyId:"AKIAW5BDQ6ZZX2KMZZFV",secretAccessKey:"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"}};if(!i.region)throw Error("Missing NEXT_PUBLIC_AWS_REGION");if(!i.credentials.accessKeyId)throw Error("Missing NEXT_PUBLIC_AWS_ACCESS_KEY_ID");if(!i.credentials.secretAccessKey)throw Error("Missing NEXT_PUBLIC_AWS_SECRET_ACCESS_KEY");if(!i.bucketName)throw Error("Missing NEXT_PUBLIC_AWS_S3_BUCKET");let a=!!i.websocketUrl,c={accessKeyId:i.credentials.accessKeyId,secretAccessKey:i.credentials.secretAccessKey};new s.S3Client({region:i.region,credentials:c});let o=a?new n.p({endpoint:i.websocketUrl,region:i.region,credentials:c}):null;i.bucketName},84908:(e,r,t)=>{"use strict";t.d(r,{z:()=>n});var s=t(96330);let n=global.prisma||new s.PrismaClient}};var r=require("../../../webpack-runtime.js");r.C(e);var t=e=>r(r.s=e),s=r.X(0,[680,547,513],()=>t(36954));module.exports=s})();